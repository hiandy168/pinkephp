define(["jquery","uploadify"],function(a){var t={createObj:function(){function t(){require([pinkephp.web_static_url+"static/components/tools/cpk_imgbox_upload.js"],function(t){function i(){if(a(".jt_imgboxupload").length>0){var e=a(".jt_imgboxupload");if(e.hasClass("jt_imgboxupload")){var i=e.attr("data-fileUploadId"),d=e.attr("data-typename"),l=e.attr("data-inputname"),o=1==e.attr("data-autoSize")?!0:!1,u=e.attr("data-width"),r=e.attr("data-height"),p=t.createObj();p.initUploadImg({fileUploadId:i,typename:d,inputname:l,autoSize:o,width:u,height:r}),e.removeClass("jt_imgboxupload")}}}if(a(document).on("click",".J_cover_config_btn",function(){var t=a(this).attr("data-triggerform"),l=a(this).attr("data-frommodule"),o=a(".j_form_item_"+t+" select[name="+t+"] option:selected").val();a.ajax({type:"post",url:"/api/file/uploadconfig",data:{catid:o,from_module:l},success:function(t){if(1==t.status){var l={};l.k=1,l.imgurl="",l.subimgurl="",l.cover_id=0,a(d.coverDivId).html(e(t.data,l)),i()}else a.custom.alert(t.msg)}})}),a(d.ajaxReplaceId).length>0){var l=a(d.ajaxReplaceId),o={};o.k=l.attr("data-k"),o.imgurl=l.attr("data-imgurl"),o.subimgurl=l.attr("data-subimgurl"),o.cover_id=parseInt("{$form['value']}");var u=l.attr("data-catid"),r=l.attr("data-frommodule");a.ajax({type:"post",url:"/api/file/uploadconfig",data:{catid:u,from_module:r},success:function(t){if(1==t.status){var l=e(t.data,o);a(d.ajaxReplaceId).parent().append(l),a(d.ajaxReplaceId).remove(),i()}else a.custom.alert(t.msg)}})}})}function e(a,t){var e='<div id="{{uploadtype}}_0Box" data-fileUploadId="#file_upload{{k}}" data-autoSize="{{autosize}}" data-inputname="{{uploadtype}}_0" data-typename="{{uploadtype}}" data-width="{{width}}" data-height="{{height}}" class="m-public-imgboxupload jt_imgboxupload j_imgboxupload" style="width: {{width}}px;height: {{height}}px;">                        <a class="imgbox" href="{{imgurl}}" rel="group" style="display:none;"><img src="{{subimgurl}}" ></a>                        <input  type="file" name="mypic" id="file_upload{{k}}" class="fileInputBox" />                        <div id="fileQueueHide" style="display: none;">                        </div>                        <div class="u-imgboxupload-removebtn" style="display: none">删除</div>                        <input type="hidden" id="j_{{uploadtype}}_0_input" name="{{uploadtype}}_0" value="{{imgurl}}">                        <input type="hidden" id="j_{{uploadtype}}_0_id_input" name="cover_id" value="{{cover_id}}">                    </div>';return e=e.replace(/{{uploadtype}}/g,a.uploadtype),e=e.replace(/{{width}}/g,a.width),e=e.replace(/{{height}}/g,a.height),e=e.replace(/{{autosize}}/g,a.autosize),e=e.replace(/{{k}}/g,t.k),e=e.replace(/{{imgurl}}/g,t.imgurl),e=e.replace(/{{subimgurl}}/g,t.subimgurl),e=e.replace(/{{cover_id}}/g,t.cover_id)}var i={},d=(a(document),{coverDivId:"",ajaxReplaceId:""});return i.init=function(e){d=a.extend({},d,e),t()},i}};return t});