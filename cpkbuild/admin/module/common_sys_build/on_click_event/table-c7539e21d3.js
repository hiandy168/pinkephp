define(["jquery","layer_dialog"],function(t,a){t(document).on("click",'img[data-tdtype="toggle"]',function(){var e=this,i=0==t(e).attr("data-value")?1:0,r=t(e).attr("data-field"),d=t(e).attr("data-id"),l=t(e).attr("src"),s=t(".j_tablelist").attr("data-acturi");return"#"!=s&&t.ajax({type:"post",url:t(".j_tablelist").attr("data-acturi"),data:{id:d,field:r,val:i},success:function(r){1==r.status?(l.indexOf("disabled")>-1?t(e).attr({src:l.replace("disabled","enabled"),"data-value":i}):t(e).attr({src:l.replace("enabled","disabled"),"data-value":i}),a.msg(r.msg,{time:500})):a.msg(r.msg)}}),!1}),t(document).on("click",'span[data-tdtype="edit"]',function(){var e=t(this),i=e.text(),r=e.attr("data-field"),d=e.attr("data-id"),l=e.width()+60;return t('<input type="text" class="form-control" value="'+i+'" />').width(l).focusout(function(){t(this).prev("span").show().text(t(this).val()),t(this).val()!=i&&t.ajax({type:"post",url:t(".j_tablelist").attr("data-acturi"),data:{id:d,field:r,val:t(this).val()},success:function(r){1==r.status?a.msg(r.msg):(e.text(i),t.custom.alert(r.msg))}}),t(this).remove()}).insertAfter(t(this)).focus().select(),t(this).hide(),!1}),t(document).on("click",".builder-table .J_field_filter_form",function(){var e=t(this),i=e.attr("data-filter"),r="undefined"!=typeof e.attr("data-title")?e.attr("data-title"):"筛选",d=e.attr("data-method"),l=e.attr("data-data"),s=e.attr("data-filter-vals"),c=e.attr("data-backurl"),n=e.attr("data-map"),o=e.attr("data-search-field"),u=e.attr("data-keyword");t.ajax({type:"get",url:pinkephp.get_filter_list,data:{method:d,data:l,filter_vals:s,backurl:c,filter:i,map:n,search_field:o,keyword:u},success:function(e){1==e.status?(a.open({type:1,fixed:!1,offset:"50px",anim:1,title:r,area:["600px","600px"],content:e.data}),console.log("Jt_builder_form_init trigger"),t(document).trigger("Jt_builder_form_init")):t.custom.alert(e.msg)}})})});